define(["jquery","underscore","backbone","nougat","BaseView","collection/settings/address","widgets/validateForm","widgets/modal","core/fpti","widgets/analytics"],function(e,t,n,r,i,s,o,u,a,f){"use strict";var l=i.extend({el:"#addressWrapper ul.addresses",pageGrp:"settings:address",events:{"click li":"onItemClick"},initialize:function(){var t=this,n="settings/address/index.dust";a.init(),a.startModuleLoadTimer(),a.recordModuleLoadTime(t.pageGrp+":view",t.pageGrp,n),this.initModels(),this.formView=new o({el:this.el})},initModels:function(){s.add(this.$el.data("collection")),this.listenTo(s,"add",this.renderAddresses),this.listenTo(s,"remove",this.renderAddresses),this.listenTo(s,"reset",this.renderAddresses),this.listenTo(s,"error",this.renderError),this.listenTo(s,"request",this.showLoading)},afterRoute:function(n){this.$(".alertMsg").remove();var r={};r.page="main:businessweb:profile:settings:address:view",r.tajnd=e.now(),r.tmpl="bizprofilenodeweb/public/templates/settings/address/index.dust",r.pgrp="main:businessweb:profile:settings:address",f.recordLoadTime(r),u.isOpen&&u.hideModal()},renderError:function(t,n,r){this.hideLoading(),this.formView.showError(r)},renderAddresses:function(n){var i=e(".settings").data("features");r.viewRenderer.render("settings/inc/addresses",{addressbook:s.toJSON()}).done(e.proxy(function(e){this.$(".alertMsg").remove(),this.$el.html(e),this.hideLoading()},this))},onItemClick:function(r){var i=e(r.currentTarget),s,o;r.target.tagName!=="A"&&e(r.target).closest("a").length===0&&(o=i.find(".fill-click"),s=o.attr("href"),s&&s!=="#"&&(s=s.replace(n.history.options.root,""),n.history.navigate(s,{trigger:!0,replace:!1})))}});return l});